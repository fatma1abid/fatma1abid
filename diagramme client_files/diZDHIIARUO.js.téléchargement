if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("MWChatMediaRootQuery.graphql",["MWChatMediaRootQuery_facebookRelayOperation","relay-runtime"],function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"after"},c={defaultValue:null,kind:"LocalArgument",name:"before"},d={defaultValue:null,kind:"LocalArgument",name:"first"},e={defaultValue:null,kind:"LocalArgument",name:"last"},f={defaultValue:null,kind:"LocalArgument",name:"messageID"},g={defaultValue:null,kind:"LocalArgument",name:"scale"},h={defaultValue:null,kind:"LocalArgument",name:"threadID"},i=[{kind:"Variable",name:"id",variableName:"threadID"}],j={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"folder",storageKey:null},l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"before",variableName:"before"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"last",variableName:"last"},{kind:"Variable",name:"message_id",variableName:"messageID"},{kind:"Literal",name:"message_shared_media_type",value:"PHOTO_VIDEO_AND_GIF"}],m={alias:null,args:null,kind:"ScalarField",name:"message_id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"timestamp_precise",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"legacy_attachment_id",storageKey:null},q={alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},t=[q,r,s,{alias:null,args:null,kind:"ScalarField",name:"downloadable_uri",storageKey:null}];q={alias:"image_thumb",args:[{kind:"Literal",name:"height",value:250},{kind:"Literal",name:"width",value:250}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[q,r,s],storageKey:"image(height:250,width:250)"};r={kind:"InlineFragment",selections:[p,{alias:null,args:null,kind:"ScalarField",name:"blurred_image_uri",storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:2048},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:2048}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:t,storageKey:null},q],type:"MessageImage",abstractKey:null};s={kind:"InlineFragment",selections:[p,{alias:"sdUrl",args:[{kind:"Literal",name:"quality",value:"SD"}],kind:"ScalarField",name:"playable_url",storageKey:'playable_url(quality:"SD")'},{alias:"hdUrl",args:[{kind:"Literal",name:"quality",value:"HD"}],kind:"ScalarField",name:"playable_url",storageKey:'playable_url(quality:"HD")'},q,{alias:null,args:null,concreteType:"Vect2",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null}],storageKey:null}],type:"MessageVideo",abstractKey:null};p={kind:"InlineFragment",selections:[p,{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:t,storageKey:null},q,{alias:null,args:null,kind:"ScalarField",name:"animated_image_caption",storageKey:null}],type:"MessageAnimatedImage",abstractKey:null};t={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null};q={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"page_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_next_page",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_previous_page",storageKey:null}],storageKey:null};var u={kind:"InlineFragment",selections:[j],type:"Node",abstractKey:"__isNode"};return{fragment:{argumentDefinitions:[a,c,d,e,f,g,h],kind:"Fragment",metadata:null,name:"MWChatMediaRootQuery",selections:[{alias:null,args:i,concreteType:"MessageThread",kind:"LinkedField",name:"message_thread",plural:!1,selections:[j,k,{alias:null,args:l,concreteType:"MessagesWithAttachmentsOfThreadConnection",kind:"LinkedField",name:"messages_with_attachments",plural:!1,selections:[{alias:null,args:null,concreteType:"MessagesWithAttachmentsOfThreadEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[m,j,n,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blob_attachments",plural:!0,selections:[o,r,s,p],storageKey:null}],type:"UserMessage",abstractKey:null}],storageKey:null},t],storageKey:null},q],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[h,f,a,d,c,e,g],kind:"Operation",name:"MWChatMediaRootQuery",selections:[{alias:null,args:i,concreteType:"MessageThread",kind:"LinkedField",name:"message_thread",plural:!1,selections:[j,k,{alias:null,args:l,concreteType:"MessagesWithAttachmentsOfThreadConnection",kind:"LinkedField",name:"messages_with_attachments",plural:!1,selections:[{alias:null,args:null,concreteType:"MessagesWithAttachmentsOfThreadEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[o,{kind:"InlineFragment",selections:[m,j,n,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blob_attachments",plural:!0,selections:[o,r,s,p,u],storageKey:null}],type:"UserMessage",abstractKey:null},u],storageKey:null},t],storageKey:null},q],storageKey:null}],storageKey:null}]},params:{id:b("MWChatMediaRootQuery_facebookRelayOperation"),metadata:{},name:"MWChatMediaRootQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a},null);
__d("CometPhotoViewerImageSuspense",["Promise","PromiseAnnotate","react"],function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=document.body,j=typeof jest==="undefined"&&document!==void 0&&typeof document.createElement==="function";function k(a){return new(b("Promise"))(function(b){if(!j||i==null)return b();var c=document.createElement("img");c.onload=c.onerror=b;c.src=a})}var l=new Map(),m=2e3,n={get:function(a){var b=l.get(a);if(b!=null){l["delete"](a);l.set(a,b);return b}},set:function(a,b){l["delete"](a);l.set(a,b);if(l.size>m){a=l.keys().next();a.done||l["delete"](a.value)}}};function o(a){if(a==null)return;var b=n.get(a);if(b!=null)if(b.pending===!0)throw b.promise;else return;else{b=k(a);d("PromiseAnnotate").setDisplayName(b,"SuspenseImage");var c={pending:!0,promise:b};b.then(function(){c.pending===!0&&(c.pending=!1)});n.set(a,c);throw b}}a=h.forwardRef(function(a,b){o(a.src);return h.jsx("img",babelHelpers["extends"]({},a,{ref:b}))});g["default"]=a},98);
__d("CometPhotoViewerInnerWrapper.react",["CometRouteRenderType","react","stylex"],function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i={backgroundContainer:{alignItems:"i85zmo3j",display:"alzwoclg",justifyContent:"jcxyg2ei",minHeight:"q41bf22h"},backgroundContainerDialog:{height:"ff443qle"},backgroundContainerDialogWithFooter:{height:"khxiaj5m"},backgroundContainerTabs:{height:"iff1jeng"},backgroundContainerTabsWithFooter:{height:"p908mtyv"},image:{height:"ikduhi8d",maxWidth:"gvxzyvdx",width:"ncxvlvn8"},maxImageHeightDialog:{maxHeight:"d65gybhy"},maxImageHeightDialogWithFooter:{maxHeight:"h4l9mpx0"},maxImageHeightTabs:{maxHeight:"q6bb8s6s"},maxImageHeightTabsWithFooter:{maxHeight:"gkp04pwp"},passthroughImage:{backgroundPosition:"thixwtv8",backgroundRepeat:"tt3ens6q",backgroundSize:"bgnsn47k",height:"pytsy3co",width:"mfclru0v"},photoWrapper:{alignItems:"i85zmo3j",display:"alzwoclg",justifyContent:"jcxyg2ei",maxHeight:"fyn85a33",position:"om3e55n1"},photoWrapperPlaceholder:{height:"pytsy3co",width:"mfclru0v"},placeholderContainer:{width:"mfclru0v"}};function j(a,b){a===void 0&&(a=!1);b===void 0&&(b=!1);var e=d("CometRouteRenderType").useIsPushView();return c("stylex")(i.backgroundContainer,!a&&e&&i.backgroundContainerDialog,!a&&!e&&i.backgroundContainerTabs,a&&e&&i.backgroundContainerDialogWithFooter,a&&!e&&i.backgroundContainerTabsWithFooter,b&&i.placeholderContainer)}function k(a,b){var e=d("CometRouteRenderType").useIsPushView();return c("stylex")(!a&&e&&i.maxImageHeightDialog,!a&&!e&&i.maxImageHeightTabs,a&&e&&i.maxImageHeightDialogWithFooter,a&&!e&&i.maxImageHeightTabsWithFooter,b&&i.passthroughImage,!b&&i.image)}function l(a,b){var c=d("CometRouteRenderType").useIsPushView();return[!a&&c&&i.maxImageHeightDialog,!a&&!c&&i.maxImageHeightTabs,a&&c&&i.maxImageHeightDialogWithFooter,a&&!c&&i.maxImageHeightTabsWithFooter,b&&i.passthroughImage,!b&&i.image]}function a(a,b){var d=a.height,e=a.imageUri,f=a.showPlaceholderImage;f=f===void 0?!0:f;var g=a.width;a=a.withFooter;a=a===void 0?!1:a;a=k(a,!0);var l=j(!1,!0);return h.jsx("div",{className:l,ref:(l=b)!=null?l:null,children:e!=null&&f&&h.jsx("div",{className:c("stylex")(i.photoWrapper,i.photoWrapperPlaceholder),children:h.jsx("div",{className:a,style:d!=null&&g!=null?{backgroundImage:"url("+e+")",maxHeight:d,maxWidth:g}:{backgroundImage:"url("+e+")"}},e)})})}a.displayName=a.name+" [from "+f.id+"]";function b(a,b){var d=a.imageComponent,e=a.imageComponentWithXStyle;a=a.withFooter;a=a===void 0?!1:a;var f=k(a,!1);a=l(a,!1);return h.jsx("div",{className:c("stylex")(i.photoWrapper),ref:b,children:d!=null?d(f):e!=null?e(a):null})}b.displayName=b.name+" [from "+f.id+"]";e=h.forwardRef(b);f=h.forwardRef(a);g.useCometPhotoViewerContainerStyles=j;g.CometPhotoViewerImageWrapper=e;g.CometPhotoViewerPlaceholderWrapper=f},98);
__d("MWInboxInfoSharedContentQPLLogger.re",["MWInboxInfoSharedContentQPLLogger.bs"],function(a,b,c,d,e,f){a=b("MWInboxInfoSharedContentQPLLogger.bs").logOpenContentViewer;f.logOpenContentViewer=a;c=b("MWInboxInfoSharedContentQPLLogger.bs").logCloseContentViewer;f.logCloseContentViewer=c},null);
__d("MWChatMediaData",[],function(a,b,c,d,e,f){"use strict";var g=function(a){return a==null||a.__typename!=="MessageVideo"||a.sdUrl==null||a.image_thumb==null||a.image_thumb.uri==null||a.image_thumb.width==null||a.image_thumb.height==null||a.original_dimensions==null||a.original_dimensions.x==null||a.original_dimensions.y==null?null:{hdUrl:a.hdUrl,imageThumb:{height:a.image_thumb.height,uri:a.image_thumb.uri,width:a.image_thumb.width},legacyAttachmentID:a.legacy_attachment_id,originalDimensions:{x:a.original_dimensions.x,y:a.original_dimensions.y},sdUrl:a.sdUrl}},h=function(a){return a==null||a.__typename!=="MessageImage"||a.image==null||a.image.uri==null||a.image.width==null||a.image.height==null||a.image_thumb==null||a.image_thumb.uri==null||a.image_thumb.width==null||a.image_thumb.height==null?null:{blurredImageUri:a.blurred_image_uri,image:{downloadableUri:a.image.downloadable_uri,height:a.image.height,uri:a.image.uri,width:a.image.width},imageThumb:{height:a.image_thumb.height,uri:a.image_thumb.uri,width:a.image_thumb.width},legacyAttachmentID:a.legacy_attachment_id}},i=function(a){return a==null||a.__typename!=="MessageAnimatedImage"||a.image==null||a.image.uri==null||a.image.width==null||a.image.height==null||a.image_thumb==null||a.image_thumb.uri==null||a.image_thumb.width==null||a.image_thumb.height==null?null:{blurredImageUri:null,image:{downloadableUri:a.image.downloadable_uri,height:a.image.height,uri:a.image.uri,width:a.image.width},imageThumb:{height:a.image_thumb.height,uri:a.image_thumb.uri,width:a.image_thumb.width},legacyAttachmentID:a.legacy_attachment_id}};a=function(a){return a.reduce(function(a,b){if(b==null||b.node==null||b.node.id==null||b.node.message_id==null||b.node.blob_attachments==null||b.cursor==null)return a;var c=b.node,d=c.blob_attachments,e=c.id,f=c.message_id,j=c.timestamp_precise,k=b.cursor;c=d.map(function(a){if(a.__typename==="MessageImage"){var b=h(a);return b==null?null:{__typename:"MessageImage",attachment:b,cursor:k,messageID:f,nodeID:e,timestamp:j}}else if(a.__typename==="MessageVideo"){b=g(a);return b==null?null:{__typename:"MessageVideo",attachment:b,cursor:k,messageID:f,nodeID:e,timestamp:j}}else if(a.__typename==="MessageAnimatedImage"){b=i(a);return b==null?null:{__typename:"MessageAnimatedImage",attachment:b,cursor:k,messageID:f,nodeID:e,timestamp:j}}else return null}).filter(Boolean);return a.concat(c)},[]).filter(Boolean)};f.normalizeMessages=a},66);
__d("MWChatMediaReducer",[],function(a,b,c,d,e,f){"use strict";a={curIdx:0,hasNextPage:!1,hasPrevPage:!1,initialCursor:null,isFetchingNextPage:!1,isFetchingPrevPage:!1,mediaList:[]};b=function(a,b){switch(b.type){case"initialize":return babelHelpers["extends"]({},a,{curIdx:b.curIdx,initialCursor:b.initialCursor,mediaList:b.mediaList});case"startFetchingNextPage":return babelHelpers["extends"]({},a,{isFetchingNextPage:!0});case"startFetchingPrevPage":return babelHelpers["extends"]({},a,{isFetchingPrevPage:!0});case"prevPageReceived":return babelHelpers["extends"]({},a,{curIdx:a.curIdx+b.medias.length,hasPrevPage:b.hasPrevPage,isFetchingPrevPage:!1,mediaList:b.medias.concat(a.mediaList)});case"nextPageReceived":return babelHelpers["extends"]({},a,{hasNextPage:b.hasNextPage,isFetchingNextPage:!1,mediaList:a.mediaList.concat(b.medias)});case"messageDeleted":return babelHelpers["extends"]({},a,{curIdx:Math.min(Math.max(b.curIdx,0),a.mediaList.length-1),mediaList:b.mediaList});case"viewMediaAtIndex":return babelHelpers["extends"]({},a,{curIdx:Math.min(Math.max(b.curIdx,0),a.mediaList.length-1)});default:return a}};f.initialState=a;f.reducer=b},66);
__d("MWChatDeleteMessageEventEmitter",["BaseEventEmitter"],function(a,b,c,d,e,f,g){"use strict";var h="deleteMessage",i=new(c("BaseEventEmitter"))();function a(a){i.emit(h,a)}function b(a){var b=i.addListener(h,a);return function(){return b.remove()}}g.emit=a;g.subscribe=b},98);
__d("MWChatMediaUtil",["ExecutionEnvironment"],function(a,b,c,d,e,f,g){"use strict";a=function(a){if(!c("ExecutionEnvironment").canUseDOM)return;a.forEach(function(a){if(typeof a==="string"){var b=new Image();b.src=a}})};g.prefetchImages=a},98);
__d("MWChatMediaViewerImage.react",["fbt","CometHero.react","CometPagelet.react","CometPhotoViewerImageSuspense","CometPhotoViewerInnerWrapper.react","CometPressable.react","react"],function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j=d("react").useState,k=h._("__JHASH__SUN00vbyQRp__JHASH__");function a(a){var b=a.blurredImageURI,e=a.imageURI,f=a.origHeight,g=a.origSrc;a=a.origWidth;var l=j(!1),m=l[0],n=l[1];l=d("CometPhotoViewerInnerWrapper.react").useCometPhotoViewerContainerStyles(!0);return i.jsx("div",{"data-testid":void 0,children:i.jsxs(d("CometPagelet.react").Placeholder,{className:l,fallback:g!=null?i.jsx(d("CometPhotoViewerInnerWrapper.react").CometPhotoViewerPlaceholderWrapper,{height:f,imageUri:g,showPlaceholderImage:g!=null&&a!=null&&f!=null,width:a,withFooter:!0}):null,name:"MessengerMediaViewerPhoto",pageletType:"media",children:[i.jsx(c("CometHero.react"),{description:"MWChatMediaViewerImage"}),b==null||m?i.jsx(d("CometPhotoViewerInnerWrapper.react").CometPhotoViewerImageWrapper,{imageComponent:function(a){return i.jsx(c("CometPhotoViewerImageSuspense"),{alt:k,className:a,src:e},e)},withFooter:!0}):i.jsx(c("CometPressable.react"),{display:"inline",label:h._("__JHASH__jjpvSNJ1g5C__JHASH__"),onPress:function(){return n(!0)},children:i.jsx(d("CometPhotoViewerInnerWrapper.react").CometPhotoViewerImageWrapper,{imageComponent:function(a){return i.jsx(c("CometPhotoViewerImageSuspense"),{alt:k,className:a,src:b},b)},withFooter:!0})})]},e)})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a},98);
__d("MWChatMediaViewerNavigationTapTarget.react",["ix","CometPressable.react","CometSkittleIcon.react","CometTrackingNodeProvider.react","fbicon","react","stylex"],function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j={buttonContainerBackground:{backgroundColor:"qminddhv"},buttonContainerHoverLeft:{opacity:"cdum9rwi",transform:"i7yo2p0r"},buttonContainerHoverRight:{opacity:"cdum9rwi",transform:"invszoqz"},fullHeight:{height:"pytsy3co"},invisible:{opacity:"jkp44r48",transitionDuration:"s19c0p35",transitionTimingFunction:"jhiaiv37",visibility:"qpyp3sab"},navButton:{alignItems:"i85zmo3j",display:"alzwoclg",opacity:"fupido9q",paddingTop:"g4qalytl",paddingEnd:"r227ecj6",paddingBottom:"ez8dtbzv",paddingStart:"gt60zsk1",position:"om3e55n1",transitionDuration:"m4pnbp5e",transitionProperty:"ctyh02ob",transitionTimingFunction:"lwpuyj9n",willChange:"bdxbjxmq"},root:{alignItems:"i85zmo3j",display:"alzwoclg",justifyContent:"jcxyg2ei",opacity:"cdum9rwi",position:"om3e55n1",transitionDuration:"pym4i58u",transitionProperty:"rhiv3dam",transitionTimingFunction:"mwa1sm0y",willChange:"fua9uuyn",zIndex:"b0ur3jhr"},tapTargetOverlay:{height:"pytsy3co"}};function a(a){var b=a.direction,e=a.disable,f=e===void 0?!1:e;e=a.invisible;e=e===void 0?!1:e;var g=a.label,k=a.onClick,l=a.testid;l=a.trackingNode;a=i.jsx(c("CometPressable.react"),{"aria-label":g,focusable:!1,onPress:k,testid:void 0,xstyle:j.tapTargetOverlay,children:function(a){a=a.hovered;return i.jsx("div",{className:c("stylex")(j.navButton,j.buttonContainerBackground,a&&(b==="previous"?j.buttonContainerHoverLeft:j.buttonContainerHoverRight)),children:i.jsx(c("CometSkittleIcon.react"),{color:"gray",disabled:f,icon:b==="previous"?d("fbicon")._(h("492491"),24):d("fbicon")._(h("492539"),24),size:48})})}});return i.jsx("div",{className:c("stylex")(j.root,e&&j.invisible,j.fullHeight),children:l!=null?i.jsx(c("CometTrackingNodeProvider.react"),{trackingNode:l,children:a}):a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a},98);
__d("MWChatMediaViewerStage.react",["fbt","CometBlurredBackgroundImage.react","CometGlobalPanelLayoutContext","CometKeys","CometLink.react","CometMediaViewerFilmstrip.react","CurrentEnvironment","Locale","MWChatMediaViewerNavigationTapTarget.react","MWLSFeatureLimitedStatus.re","MessengerBlurpleLogoSvg.re","XMessengerDotComCometRootControllerRouteBuilder","deferredLoadComponent","gkx","react","requireDeferred","stylex","useCometRouterDispatcher","useDebouncedComet","useLayerKeyCommands","useLayoutEffect_SAFE_FOR_SSR"],function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");b=d("react");var j=b.useContext,k=b.useMemo,l=b.useRef,m=b.useState,n=c("deferredLoadComponent")(c("requireDeferred")("MWChatMediaViewerControls.react").__setRef("MWChatMediaViewerStage.react")),o=2e3,p=c("gkx")("1299319");function a(a){var b=a.activeIndex,e=a.attachmentID,f=a.backgroundSrc,g=a.children,q=a.disableNextButton,r=a.disablePrevButton,s=a.downloadLink,t=a.hideNextButton,u=a.hidePrevButton,v=a.isForwardEnabledForThread,w=a.messageID,x=a.setActiveIndex,y=a.showMessengerLink,z=j(c("CometGlobalPanelLayoutContext")),A=c("CurrentEnvironment").messengerdotcom,B=c("gkx")("1224637"),C=c("gkx")("7278"),D=d("MWLSFeatureLimitedStatus.re").useIsReadOnlyFeatureLimited();D=c("gkx")("1844772")&&!D&&v;var E=h._("__JHASH__LwpPfoJWBJ-__JHASH__"),F=h._("__JHASH__37s-bUHecpV__JHASH__"),G=l(!0);v=m(!1);var H=v[0],I=v[1],J=l(null),K=c("useCometRouterDispatcher")();v=function(){return L.isPending()?M():L()};var L=c("useDebouncedComet")(function(){I(!1),M()},{leading:!0,wait:o}),M=c("useDebouncedComet")(function(){I(!0),G.current=!1},{leading:!1,wait:o});c("useLayoutEffect_SAFE_FOR_SSR")(function(){M(),J.current&&G.current&&J.current.focus()});var N=function(){K!=null&&K.popPushView()},O=k(function(){var b=[];!u&&!r&&b.push({command:{key:c("CometKeys").LEFT},description:E,handler:function(){return x(a.activeIndex-1)}});!t&&!q&&b.push({command:{key:c("CometKeys").RIGHT},description:F,handler:function(){return x(a.activeIndex+1)}});return b},[q,r,t,u,F,E,a.activeIndex,x]),P=i.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:d("Locale").isRTL()?"next":"previous",disable:r,invisible:u||H,label:E,onClick:function(){return x(b-1)},testid:void 0,trackingNode:143});H=i.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:d("Locale").isRTL()?"previous":"next",disable:q,invisible:t||H,label:F,onClick:function(){return x(b+1)},testid:void 0,trackingNode:142});c("useLayerKeyCommands")(O);return i.jsxs("div",{className:"th8rvtx1 f14ij5to om3e55n1 h93itd9g pytsy3co cgu29s5g cqf1kptm alzwoclg sfdena2r i85zmo3j","data-testid":void 0,onMouseMove:v,ref:J,tabIndex:"0",children:[y&&i.jsx("div",{className:"afopkvs9 jqx9f4jw bbqlx7z3 s8sjc6am",children:i.jsx(c("CometLink.react"),{"aria-label":"Messenger",href:c("XMessengerDotComCometRootControllerRouteBuilder").buildURL({}),children:i.jsx(d("MessengerBlurpleLogoSvg.re").make,{height:"40",width:"40"})})}),i.jsx("div",{className:"b0ur3jhr mfclru0v s8sjc6am mhz3x5iv tvs1sg6e"}),i.jsx("div",{className:"ekq1a7f9 myo4itp8 s8sjc6am hbttzuxt on4d8346 z6erz7xo",children:f!=null?i.jsx(c("CometBlurredBackgroundImage.react"),{src:f}):null}),i.jsxs("div",{className:"mfclru0v om3e55n1 hf30pyar lq84ybu9 jcxyg2ei pytsy3co cgu29s5g alzwoclg bdao358l ebgb6ll2 mi6o6rut",children:[e!=null&&w!=null?i.jsx("div",{className:c("stylex")({"align-items-1":"i85zmo3j","display-1":"alzwoclg","end-1":"s0hvyppw","height-1":"k3q8kl47","position-1":"s8sjc6am","z-index-1":"b0ur3jhr"},z?{"height-1":"djlrhwyo"}:null,A?{"end-1":"on4d8346","height-1":"djlrhwyo"}:null,B?{"end-1":"k1uss64g","height-1":"a26p89d5","z-index-1":"j7qd3pol"}:null,C?{"end-1":"k1uss64g","height-1":"a26p89d5","z-index-1":"j7qd3pol"}:null),children:i.jsx(n,{attachmentID:e,canForward:D,downloadLink:s,messageID:w})}):null,i.jsxs("div",{className:"g4tp4svg ekq1a7f9 myo4itp8 s8sjc6am sl27f92c on4d8346 alzwoclg z6erz7xo i85zmo3j",children:[!p&&i.jsx("div",{"aria-hidden":!0,className:"ekq1a7f9 myo4itp8 s8sjc6am on4d8346 bdao358l z6erz7xo","data-testid":void 0,onClick:N}),P,H]}),g]}),i.jsx("div",{className:"hf30pyar lq84ybu9 gvxzyvdx",children:i.jsx(c("CometMediaViewerFilmstrip.react"),{activeIndex:b,images:a.thumbnails.map(function(a){return babelHelpers["extends"]({},a,{mediaType:"image"})}),onSetImage:x})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a},98);
__d("MWChatMediaViewerVideo.react",["CometRouteRenderType","MWChatVideoPlayer.react","react","stylex"],function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=d("CometRouteRenderType").useIsPushView();return h.jsx("div",{className:c("stylex")({"align-items-1":"i85zmo3j","display-1":"alzwoclg","flex-grow-1":"cgu29s5g","justify-content-1":"jcxyg2ei","min-height-1":"q41bf22h","width-1":"mfclru0v"},b?{"height-1":"khxiaj5m"}:null,b?null:{"height-1":"tsgmnz5v"}),children:h.jsx(c("MWChatVideoPlayer.react"),{controls:"default",fbid:a.fbid,hdSrc:a.hdSrc,initialForceHD:!0,originalHeight:a.originalHeight,originalWidth:a.originalWidth,sdSrc:a.sdSrc})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a},98);
__d("MWChatMediaRoot.react",["fbt","CometContentNotAvailable.react","CometErrorBoundary.react","CometErrorRoot.react","CometRelay","CometRouteParams","CometRouterPushViewStackContext","MWChatDeleteMessageEventEmitter","MWChatMediaData","MWChatMediaReducer","MWChatMediaRootQuery.graphql","MWChatMediaUtil","MWChatMediaViewerImage.react","MWChatMediaViewerStage.react","MWChatMediaViewerVideo.react","MWChatMessageId.re","MWInboxInfoSharedContentQPLLogger.re","WebPixelRatio","react","useIsMountedRef"],function(a,b,c,d,e,f,g,h){"use strict";var i,j=d("react");e=d("react");var k=e.useCallback,l=e.useContext,m=e.useEffect,n=e.useReducer,o=e.useState,p=20,q=i!==void 0?i:i=b("MWChatMediaRootQuery.graphql");function r(a){var b=a.props;a=a.queries;var e=d("CometRelay").useRelayEnvironment(),f=d("CometRouteParams").useRouteParams();b.manualRouteParams!=null&&(f=b.manualRouteParams);var g=l(c("CometRouterPushViewStackContext"))||[];g=g.length===0&&b.routeProps.showMessengerLink;b=o(null);var i=b[0],r=b[1];b=n(d("MWChatMediaReducer").reducer,d("MWChatMediaReducer").initialState);var s=b[0],t=s.curIdx,u=s.hasNextPage,v=s.hasPrevPage,w=s.initialCursor,x=s.isFetchingNextPage,y=s.isFetchingPrevPage,z=s.mediaList,A=b[1],B=c("useIsMountedRef")(),C=d("CometRelay").usePreloadedQuery(q,a.messengerMediaRootQueryReference);if(i!==null)throw i;m(function(){var a;a=C==null?void 0:(a=C.message_thread)==null?void 0:(a=a.messages_with_attachments)==null?void 0:(a=a.edges[0])==null?void 0:a.cursor;if(a!=null&&w===null){var b;b=C==null?void 0:(b=C.message_thread)==null?void 0:(b=b.messages_with_attachments)==null?void 0:b.edges;if(b!=null){b=d("MWChatMediaData").normalizeMessages(b);var c=0;f.attachment_id!=null&&(c=b.findIndex(function(a){return a.attachment.legacyAttachmentID===f.attachment_id}));A({curIdx:c,initialCursor:a,mediaList:b,type:"initialize"})}}},[w,C,f.attachment_id]);var D=C==null?void 0:(s=C.message_thread)==null?void 0:s.id;a=C==null?void 0:(b=C.message_thread)==null?void 0:b.folder;m(function(){var a=d("MWChatDeleteMessageEventEmitter").subscribe(function(a){var b=t,c=z.filter(function(c,d){c=c.messageID===a;c&&(d<=t&&t>0&&b--);return!c});c.length!==z.length&&(D!=null&&e.commitUpdate(function(a){return(a=a.get(D))==null?void 0:a.invalidateRecord()}));A({curIdx:b,mediaList:c,type:"messageDeleted"})});return a},[e,D,t,z]);var E=k(function(a){A({type:"startFetchingPrevPage"});return d("CometRelay").fetchQuery(e,q,{before:a,last:p,scale:d("WebPixelRatio").get(),threadID:f.thread_id}).toPromise().then(function(a){var b;if(!B.current)return;a=a==null?void 0:(a=a.message_thread)==null?void 0:a.messages_with_attachments;b=d("MWChatMediaData").normalizeMessages((b=a==null?void 0:a.edges)!=null?b:[]);if(b.length>0){A({hasPrevPage:(a=a==null?void 0:(a=a.page_info)==null?void 0:a.has_previous_page)!=null?a:!1,medias:b,type:"prevPageReceived"})}})["catch"](function(a){if(!B.current)return;r(a)})},[e,B,f.thread_id]),F=k(function(a){A({type:"startFetchingNextPage"});return d("CometRelay").fetchQuery(e,q,{after:a,first:p,scale:d("WebPixelRatio").get(),threadID:f.thread_id}).toPromise().then(function(a){var b;if(!B.current)return;a=a==null?void 0:(a=a.message_thread)==null?void 0:a.messages_with_attachments;b=d("MWChatMediaData").normalizeMessages((b=a==null?void 0:a.edges)!=null?b:[]);if(b.length>0){A({hasNextPage:(a=a==null?void 0:(a=a.page_info)==null?void 0:a.has_next_page)!=null?a:!1,medias:b,type:"nextPageReceived"})}})["catch"](function(a){if(!B.current)return;r(a)})},[e,B,f.thread_id]);m(function(){w!=null&&(F(w),E(w))},[e,F,E,w,f.thread_id]);var G=(s=(i=z[0])==null?void 0:i.cursor)!=null?s:null,H=(i=(b=z[z.length-1])==null?void 0:b.cursor)!=null?i:null;m(function(){t<=p/2&&v&&!y&&G!=null?E(G):t>=z.length-p/2&&u&&!x&&H!=null&&F(H)},[t,E,F,u,v,G,H,z.length,x,y]);s=z[t-1];b=z[t+1];var I=null,J=null;s!=null&&s.__typename==="MessageImage"&&(I=s.attachment.image.uri);b!=null&&b.__typename==="MessageImage"&&(J=b.attachment.image.uri);m(function(){d("MWChatMediaUtil").prefetchImages([I,J])},[I,J]);m(function(){d("MWInboxInfoSharedContentQPLLogger.re").logOpenContentViewer()},[]);i=z[t];if(w==null)return null;if(i==null)return j.jsx(c("CometContentNotAvailable.react"),{});s=z.map(function(a){var b=a.attachment.imageThumb,c=b.height,d=b.uri;b=b.width;return{alt:h._("__JHASH__SUN00vbyQRp__JHASH__"),height:c,key:(c=a.attachment.legacyAttachmentID)!=null?c:d,uri:d,width:b}}).filter(Boolean);return j.jsx(c("MWChatMediaViewerStage.react"),{activeIndex:t,attachmentID:i.attachment.legacyAttachmentID,backgroundSrc:i.__typename!=="MessageAnimatedImage"?i.attachment.imageThumb.uri:void 0,disableNextButton:x&&z[t+1]==null,disablePrevButton:y&&z[t-1]==null,downloadLink:i.__typename==="MessageVideo"?(b=i.attachment.hdUrl)!=null?b:i.attachment.sdUrl:i.attachment.image.downloadableUri,hideNextButton:!u&&z[t+1]==null,hidePrevButton:!v&&z[t-1]==null,isForwardEnabledForThread:a!=="COMMUNITY"&&a!=="E2EE_CUTOVER",messageID:typeof f.thread_id==="string"&&i.timestamp!=null?d("MWChatMessageId.re").makeSent(f.thread_id,i.messageID,i.timestamp):null,setActiveIndex:function(a){return A({curIdx:a,type:"viewMediaAtIndex"})},showMessengerLink:g,thumbnails:s,children:i.__typename==="MessageVideo"?j.jsx(c("MWChatMediaViewerVideo.react"),{fbid:i.nodeID,hdSrc:i.attachment.hdUrl!=null?i.attachment.hdUrl:void 0,originalHeight:i.attachment.originalDimensions.x,originalWidth:i.attachment.originalDimensions.y,sdSrc:i.attachment.sdUrl}):i.__typename==="MessageImage"?j.jsx(c("MWChatMediaViewerImage.react"),{blurredImageURI:i.attachment.blurredImageUri,imageURI:i.attachment.image.uri}):i.__typename==="MessageAnimatedImage"?j.jsx(c("MWChatMediaViewerImage.react"),{blurredImageURI:null,imageURI:i.attachment.image.uri,origHeight:i.attachment.image.height,origWidth:i.attachment.image.width}):null})}r.displayName=r.name+" [from "+f.id+"]";function a(a){a=j.jsx(r,babelHelpers["extends"]({},a));return j.jsx(c("CometErrorBoundary.react"),{fallback:function(){return j.jsx(c("CometErrorRoot.react"),{})},children:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a},98);